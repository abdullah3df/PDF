<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุฎุฏูุงุช PDF & CV โ ูููุน ูุชูุงูู ุจููู ูุงุญุฏ</title>
  <meta name="description" content="ูููุน ููุฏู ุฃุฏูุงุช PDF (ุฏูุฌุ ุชูุณููุ ุตูุฑโPDF) ูููุดุฆ ุณูุฑุฉ ุฐุงุชูุฉ ูุน ุชุตุฏูุฑ PDF โ ูุนูู ุจุงููุงูู ุฏุงุฎู ุงููุชุตูุญ.">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <style>
    :root {
      --bg: #0b1220;
      --card: #121a2b;
      --muted: #93a4c7;
      --text: #e9eefb;
      --brand: #3aa9ff;
      --brand-2:#7ee787;
      --danger:#ff6b6b;
      --accent:#ffd166;
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#0d1426 35%,#0a0f1d 100%);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Noto Sans Arabic",Tahoma,Arial,sans-serif}
    a{color:var(--brand)}
    .container{max-width:1180px;margin:auto;padding:24px}
    .nav{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;margin-bottom:16px}
    .logo{display:flex;align-items:center;gap:10px;font-weight:800}
    .logo-badge{width:36px;height:36px;border-radius:50%;display:grid;place-items:center;background:radial-gradient(circle at 30% 30%,var(--brand),#6dd3ff 40%,#0049ff)}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab-btn{border:1px solid #223050;background:#0e1626;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer;transition:0.2s}
    .tab-btn[aria-selected="true"], .tab-btn:hover{background:linear-gradient(180deg,#12213b,#0e1626);border-color:#2a3a5d;box-shadow:0 0 0 2px rgb(58 169 255 / .18) inset}.grid{display:grid;grid-template-columns:1.15fr 1fr;gap:18px}
@media (max-width: 980px){.grid{grid-template-columns:1fr}}

.card{background:linear-gradient(180deg,#0f1730,#0c1326);border:1px solid #243354;border-radius:var(--radius);padding:18px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
.card h2{margin:0 0 6px;font-size:20px}
.muted{color:var(--muted);font-size:13px}

.panel{display:none}
.panel.active{display:block;animation:fade .25s ease}
@keyframes fade{from{opacity:.4;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}

.drop{border:1.5px dashed #35507f;border-radius:14px;padding:18px;text-align:center;background:#0e1628}
.drop input{display:none}
.drop label{display:inline-block;padding:10px 14px;border-radius:10px;background:#13213a;border:1px solid #2b3e66;cursor:pointer}

.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid #2b3e66;background:#14223b;color:var(--text);cursor:pointer}
.btn.brand{background:linear-gradient(180deg,#1a6eff,#1147ff);border-color:#2f55ff}
.btn.good{background:linear-gradient(180deg,#15803d,#166534);border-color:#2e7d32}
.btn.danger{background:linear-gradient(180deg,#b91c1c,#7f1d1d);border-color:#7f1d1d}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

.list{margin:10px 0 0;padding:0;list-style:none;max-height:180px;overflow:auto;border:1px solid #223356;border-radius:12px}
.list li{padding:8px 12px;border-bottom:1px solid #1d2a45;font-size:14px;display:flex;justify-content:space-between;gap:10px}
.list li:last-child{border-bottom:0}

.field{display:flex;flex-direction:column;gap:6px;margin:8px 0}
.field input,.field textarea, .field select{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #2b3e66;background:#0e1628;color:var(--text)}
.field textarea{min-height:110px;resize:vertical}

.cv{background:linear-gradient(180deg,#0e1529,#0c1222);border:1px solid #273455;border-radius:16px;padding:18px}
.cv .sheet{width:794px; /* A4 at 96dpi */ min-height:1123px;background:#ffffff;color:#0d1321;margin:auto;border-radius:8px;box-shadow:0 0 0 1px #e6eaf3 inset;overflow:hidden}
@media (max-width: 820px){.cv .sheet{width:100%}}
.cv-header{display:flex;gap:16px;align-items:center;padding:22px 26px;background:linear-gradient(90deg,#0b1220 0%,#133869 100%);color:#fff}
.avatar{width:84px;height:84px;border-radius:50%;background:#d1d5db;overflow:hidden;border:3px solid rgba(255,255,255,.18)}
.avatar img{width:100%;height:100%;object-fit:cover}
.cv-body{display:grid;grid-template-columns:280px 1fr}
@media (max-width: 720px){.cv-body{grid-template-columns:1fr}}
.cv-side{background:#f6f8fc;padding:18px}
.cv-main{padding:22px}
.tag{display:inline-block;padding:2px 8px;border-radius:999px;background:#eef2ff;color:#1e3a8a;font-size:12px;margin:0 4px 6px 0}
.skill{height:8px;background:#e5e7eb;border-radius:999px;overflow:hidden}
.skill > span{display:block;height:100%;background:#2563eb}

.footer{margin-top:28px;text-align:center;font-size:12px;color:var(--muted)}

  </style>
</head>
<body>
  <div class="container">
    <div class="nav">
      <div class="logo" title="ุฎุฏูุงุช PDF & CV">
        <span class="logo-badge">๐</span>
        <span>ุฎุฏูุงุช PDF & CV</span>
      </div>
      <div class="tabs" role="tablist" aria-label="ุงูุฃูุณุงู">
        <button class="tab-btn" data-tab="pdf" aria-selected="true">ุฃุฏูุงุช PDF</button>
        <button class="tab-btn" data-tab="cv">ููุดุฆ ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ</button>
        <button class="tab-btn" data-tab="about">ุงูุชุนุฑูู & ุงูุชุณุนูุฑ</button>
      </div>
    </div><!-- PDF TOOLS PANEL -->
<section id="panel-pdf" class="panel active">
  <div class="grid">
    <div class="card">
      <h2>ุฏูุฌ ูููุงุช PDF</h2>
      <p class="muted">ุงุฑูุน ุนุฏุฉ ูููุงุช PDF ุจุชุฑุชูุจู ุซู ุงุถุบุท ุฏูุฌ.</p>
      <div class="drop" id="merge-drop">
        <input type="file" id="merge-input" accept="application/pdf" multiple>
        <label for="merge-input">ุงุฎุชุฑ ูููุงุช PDF</label>
        <ul id="merge-list" class="list" aria-live="polite"></ul>
      </div>
      <div class="row" style="margin-top:10px">
        <button class="btn brand" id="merge-btn">ุฏููุฌ ูุชุญููู</button>
        <button class="btn" id="merge-clear">ุชูุฑูุบ</button>
      </div>
    </div>

    <div class="card">
      <h2>ุชูุณูู ููู PDF</h2>
      <p class="muted">ุงุฎุชุฑ ููููุง ูุฃุฏุฎู ุงูุตูุญุงุช ูุซู: <b>1-3,5,8-9</b></p>
      <div class="field">
        <input type="file" id="split-input" accept="application/pdf">
      </div>
      <div class="field">
        <label for="ranges">ูุทุงู ุงูุตูุญุงุช</label>
        <input id="ranges" placeholder="ูุซุงู: 1-2,4,7-9" />
      </div>
      <div class="row">
        <button class="btn brand" id="split-btn">ุชูุณูู ูุชุญููู</button>
        <button class="btn" id="split-clear">ุชูุฑูุบ</button>
      </div>
    </div>

    <div class="card">
      <h2>ุตูุฑ โ PDF</h2>
      <p class="muted">ุญููู ุตูุฑ JPG/PNG ุฅูู ููู PDF ูุงุญุฏ (ุตูุญุฉ ููู ุตูุฑุฉ).</p>
      <div class="field">
        <input type="file" id="img2pdf-input" accept="image/*" multiple>
      </div>
      <div class="row">
        <label>ุญุฌู ุงูุตูุญุฉ:
          <select id="paper">
            <option value="a4">A4</option>
            <option value="letter">Letter</option>
          </select>
        </label>
        <label>ููุงุกูุฉ:
          <select id="fit">
            <option value="contain">ุงุญุชูุงุก</option>
            <option value="cover">ููุก ุงูุตูุญุฉ</option>
          </select>
        </label>
        <button class="btn good" id="img2pdf-btn">ุชุญููู ูุชุญููู</button>
      </div>
    </div>

    <div class="card">
      <h2>ูุตุงุฆุญ</h2>
      <ul>
        <li>ูู ุงูุฃุฏูุงุช ุชุนูู ุฏุงุฎู ุงููุชุตูุญ (ุจุฏูู ุฑูุน ูููุงุช ุฅูู ุฎุงุฏู).</li>
        <li>ูุถุบุท PDF ูุจูุฑุ ุฌุฑูุจ ุฅุนุงุฏุฉ ุชุตุฏูุฑู ุนุจุฑ "ุตูุฑ โ PDF" ูุน ุตูุฑ ุฃุฎู.</li>
        <li>ููููู ุชุบููุฑ ุชุฑุชูุจ ูููุงุช ุงูุฏูุฌ ุจุณุญุจูุง ูู ุงููุงุฆูุฉ.</li>
      </ul>
    </div>
  </div>
</section>

<!-- CV BUILDER PANEL -->
<section id="panel-cv" class="panel">
  <div class="grid">
    <div class="card">
      <h2>ุจูุงูุงุช ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ</h2>
      <div class="field">
        <label>ุงูุงุณู ุงููุงูู</label>
        <input id="cv-name" placeholder="ุงูุงุณู" />
      </div>
      <div class="field">
        <label>ุงููุณูู ุงููุธููู</label>
        <input id="cv-title" placeholder="ูุซุงู: ูุทููุฑ ูุงุฌูุงุช" />
      </div>
      <div class="field">
        <label>ุงูููุฎุต ุงููููู</label>
        <textarea id="cv-summary" placeholder="ูุจุฐุฉ ูุตูุฑุฉโฆ"></textarea>
      </div>
      <div class="field">
        <label>ุงูุฎุจุฑุงุช (ูู ุฎุจุฑุฉ ูู ุณุทุฑ)</label>
        <textarea id="cv-exp" placeholder="ุงูุดุฑูุฉ โ ุงูููุตุจ โ ุงูุณููุงุช"></textarea>
      </div>
      <div class="field">
        <label>ุงูุชุนููู</label>
        <textarea id="cv-edu" placeholder="ุงูุฌุงูุนุฉ โ ุงูุฏุฑุฌุฉ โ ุงูุณููุงุช"></textarea>
      </div>
      <div class="field">
        <label>ุงูููุงุฑุงุช (ููุตููุฉ ุจููุงุตู)</label>
        <input id="cv-skills" placeholder="JavaScript, React, Weldingโฆ" />
      </div>
      <div class="field">
        <label>ุงูุตูุฑุฉ (ุงุฎุชูุงุฑู)</label>
        <input type="file" id="cv-photo" accept="image/*" />
      </div>
      <div class="row">
        <button class="btn brand" id="cv-generate">ุชุญุฏูุซ ุงููุนุงููุฉ</button>
        <button class="btn good" id="cv-download">ุชุญููู PDF</button>
        <button class="btn" id="cv-clear">ุชูุฑูุบ</button>
      </div>
    </div>

    <div class="card cv">
      <h2 style="margin-bottom:10px">ูุนุงููุฉ ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ</h2>
      <div id="cv-sheet" class="sheet" aria-label="ูุนุงููุฉ ูุงุจูุฉ ููุทุจุงุนุฉ">
        <div class="cv-header">
          <div class="avatar" id="cv-avatar"></div>
          <div>
            <div id="cv-name-v" style="font-size:26px;font-weight:800">ุงูุงุณู ุงููุงูู</div>
            <div id="cv-title-v" style="opacity:.9">ุงููุณูู ุงููุธููู</div>
          </div>
        </div>
        <div class="cv-body">
          <aside class="cv-side">
            <h3 style="margin-top:0">ุงูููุงุฑุงุช</h3>
            <div id="cv-skills-v"></div>
          </aside>
          <main class="cv-main">
            <section>
              <h3 style="margin-top:0">ุงูููุฎุต</h3>
              <p id="cv-summary-v">ุงูุชุจ ููุฎุตู ุงููููู ุจุฅูุฌุงุฒ ููุถูุญ.</p>
            </section>
            <section>
              <h3>ุงูุฎุจุฑุงุช</h3>
              <div id="cv-exp-v"></div>
            </section>
            <section>
              <h3>ุงูุชุนููู</h3>
              <div id="cv-edu-v"></div>
            </section>
          </main>
        </div>
      </div>
      <div class="footer">* ุณูุชู ุญูุธ ูู ุดูุก ูุญูููุง ูู ุงููุชุตูุญ (LocalStorage).</div>
    </div>
  </div>
</section>

<!-- ABOUT PANEL -->
<section id="panel-about" class="panel">
  <div class="grid" style="grid-template-columns:1fr">
    <div class="card">
      <h2>ุนู ุงููููุน ูุงูุชุณุนูุฑ</h2>
      <p class="muted">ูุฐุง ุงููุงูุจ ูุนูู 100% ุนูู ุงููุงุฌูุฉ (FrontโEnd) ููููู ูุดุฑู ุนูู GitHub Pages ุฃู Netlify ุจุณูููุฉ.
        ููููู ูุงุญููุง ุฅุถุงูุฉ ุจูุงุจุฉ ุฏูุน (Stripe) ูููู ุจุนุถ ุงูููุฒุงุช ุงููุชูุฏูุฉ.</p>
      <ul>
        <li><b>ุงูุฎุทุฉ ุงููุฌุงููุฉ:</b> ุฏูุฌ ุญุชู 10 ูููุงุชุ ุชูุณูู ุญุชู 30 ุตูุญุฉุ ูุงูุจ CV ูุงุญุฏ.</li>
        <li><b>ุงูุฎุทุฉ ุงููุฏููุนุฉ:</b> ุบูุฑ ูุญุฏูุฏ + ููุงูุจ CV ุฅุถุงููุฉ + ุญูุธ ุณุญุงุจู.</li>
      </ul>
      <p>ุงูุฎุตูุตูุฉ: ูุง ูุชู ุฑูุน ุงููููุงุช ูุฃู ุฎุงุฏู ูู ูุฐู ุงููุณุฎุฉุ ูู ุงููุนุงูุฌุฉ ุชุชู ุฏุงุฎู ุฌูุงุฒ ุงููุณุชุฎุฏู.</p>
    </div>
  </div>
</section>

<div class="footer">ยฉ <span id="year"></span> โ ูููุน ุฎุฏูุงุช PDF & CV โ ูุณุฎุฉ ูุจุฏุฆูุฉ ุฌุงูุฒุฉ ููุชุทููุฑ</div>

  </div>  <!-- Libraries -->  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>  <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>  <script>
    // ===== Tabs =====
    const tabs = document.querySelectorAll('.tab-btn');
    const panels = {
      pdf: document.getElementById('panel-pdf'),
      cv: document.getElementById('panel-cv'),
      about: document.getElementById('panel-about')
    };
    tabs.forEach(btn=>{
      btn.addEventListener('click',()=>{
        tabs.forEach(b=>b.setAttribute('aria-selected','false'));
        btn.setAttribute('aria-selected','true');
        Object.values(panels).forEach(p=>p.classList.remove('active'));
        panels[btn.dataset.tab].classList.add('active');
      })
    });

    // ===== YEAR =====
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===== Helpers =====
    const $ = sel => document.querySelector(sel);
    function downloadBlob(bytes, filename, type='application/pdf'){
      const blob = new Blob([bytes], {type});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = filename; a.click();
      URL.revokeObjectURL(url);
    }

    // ===== MERGE PDF =====
    const mergeInput = document.getElementById('merge-input');
    const mergeList = document.getElementById('merge-list');
    const mergeFiles = [];

    function refreshMergeList(){
      mergeList.innerHTML = '';
      mergeFiles.forEach((f,idx)=>{
        const li = document.createElement('li');
        li.draggable = true;
        li.innerHTML = `<span>${idx+1}. ${f.name} <small class="muted">(${(f.size/1024/1024).toFixed(2)} MB)</small></span><button class="btn danger" data-i="${idx}">ุญุฐู</button>`;
        mergeList.appendChild(li);
      });
    }
    mergeList.addEventListener('click', (e)=>{
      const i = e.target.dataset.i;
      if(i!==undefined){ mergeFiles.splice(+i,1); refreshMergeList(); }
    });
    // Drag reorder
    let dragIdx=null;
    mergeList.addEventListener('dragstart', e=>{
      dragIdx = [...mergeList.children].indexOf(e.target);
    });
    mergeList.addEventListener('dragover', e=>{ e.preventDefault(); });
    mergeList.addEventListener('drop', e=>{
      e.preventDefault();
      const dropIdx = [...mergeList.children].indexOf(e.target.closest('li'));
      if(dragIdx>=0 && dropIdx>=0 && dragIdx!==dropIdx){
        const [m] = mergeFiles.splice(dragIdx,1);
        mergeFiles.splice(dropIdx,0,m);
        refreshMergeList();
      }
    });

    mergeInput.addEventListener('change', (e)=>{
      [...e.target.files].forEach(f=>mergeFiles.push(f));
      refreshMergeList();
    });
    document.getElementById('merge-clear').onclick = ()=>{ mergeFiles.length=0; refreshMergeList(); };

    document.getElementById('merge-btn').onclick = async ()=>{
      if(!mergeFiles.length) return alert('ุฃุถู ูููุงุช ุฃููุงู');
      const { PDFDocument } = PDFLib;
      const merged = await PDFDocument.create();
      for(const f of mergeFiles){
        const bytes = await f.arrayBuffer();
        const src = await PDFDocument.load(bytes, { ignoreEncryption: true });
        const pages = await merged.copyPages(src, src.getPageIndices());
        pages.forEach(p=>merged.addPage(p));
      }
      const out = await merged.save({
        addDefaultPage:false,
      });
      downloadBlob(out, `merged_${Date.now()}.pdf`);
    };

    // ===== SPLIT PDF =====
    document.getElementById('split-clear').onclick = ()=>{ $('#split-input').value=''; $('#ranges').value=''; };

    function parseRanges(str, total){
      const set = new Set();
      str.split(',').map(s=>s.trim()).filter(Boolean).forEach(part=>{
        if(part.includes('-')){
          const [a,b] = part.split('-').map(n=>parseInt(n,10));
          const from = Math.min(a,b), to = Math.max(a,b);
          for(let i=from;i<=to;i++) if(i>=1 && i<=total) set.add(i-1);
        }else{
          const n = parseInt(part,10); if(n>=1 && n<=total) set.add(n-1);
        }
      });
      return [...set].sort((x,y)=>x-y);
    }

    document.getElementById('split-btn').onclick = async ()=>{
      const file = document.getElementById('split-input').files?.[0];
      const ranges = document.getElementById('ranges').value.trim();
      if(!file) return alert('ุงุฎุชุฑ ููู PDF');
      const bytes = await file.arrayBuffer();
      const { PDFDocument } = PDFLib;
      const src = await PDFDocument.load(bytes, { ignoreEncryption: true });
      const total = src.getPageCount();
      const indices = ranges ? parseRanges(ranges, total) : src.getPageIndices();
      if(!indices.length) return alert('ูุง ุชูุฌุฏ ุตูุญุงุช ูุทุงุจูุฉ ูููุทุงู');
      const outDoc = await PDFDocument.create();
      const pages = await outDoc.copyPages(src, indices);
      pages.forEach(p=>outDoc.addPage(p));
      const out = await outDoc.save();
      downloadBlob(out, `split_${Date.now()}.pdf`);
    };

    // ===== IMAGES โ PDF =====
    const sizeMap = {
      a4: { w: 595.28, h: 841.89 }, // pt
      letter: { w: 612, h: 792 }
    };

    document.getElementById('img2pdf-btn').onclick = async ()=>{
      const files = document.getElementById('img2pdf-input').files;
      if(!files || !files.length) return alert('ุงุฎุชุฑ ุตูุฑูุง ุฃููุงู');
      const paper = document.getElementById('paper').value;
      const fit = document.getElementById('fit').value; // contain | cover
      const { jsPDF } = window.jspdf;

      // ุฅุฐุง ูู ุชุชููุฑ jsPDF ูู html2pdfุ ููุดุฆ ูุซูู ูุฏูููุง
      const pdf = new jsPDF({ unit:'pt', format:[sizeMap[paper].w, sizeMap[paper].h], orientation:'portrait' });

      for(let i=0;i<files.length;i++){
        const img = await fileToImage(files[i]);
        if(i>0) pdf.addPage([sizeMap[paper].w, sizeMap[paper].h], 'portrait');
        const rect = fitRect(img.width, img.height, sizeMap[paper].w, sizeMap[paper].h, fit);
        pdf.addImage(imgToDataURL(img), undefined, rect.x, rect.y, rect.w, rect.h);
      }
      pdf.save(`images_${Date.now()}.pdf`);
    };

    function fileToImage(file){
      return new Promise((resolve,reject)=>{
        const reader = new FileReader();
        reader.onload = ()=>{
          const img = new Image();
          img.onload=()=>resolve(img);
          img.onerror=reject;
          img.src = reader.result;
        };
        reader.onerror=reject;
        reader.readAsDataURL(file);
      });
    }
    function imgToDataURL(img){
      const c = document.createElement('canvas');
      c.width = img.width; c.height = img.height;
      const ctx = c.getContext('2d');
      ctx.drawImage(img,0,0);
      return c.toDataURL('image/jpeg', 0.92);
    }
    function fitRect(iw, ih, cw, ch, mode='contain'){
      const ir = iw/ih, cr = cw/ch;
      let w,h;
      if((mode==='contain' && ir>cr) || (mode==='cover' && ir<cr)){
        w = cw; h = w/ir;
      }else{ h = ch; w = h*ir; }
      const x = (cw - w)/2, y = (ch - h)/2;
      return {x,y,w,h};
    }

    // ===== CV BUILDER =====
    const store = (k,v)=>localStorage.setItem(k, JSON.stringify(v));
    const load = (k, def)=>{ try{ return JSON.parse(localStorage.getItem(k)) ?? def }catch{ return def }}

    function syncPreview(){
      const name = $('#cv-name').value.trim() || 'ุงูุงุณู ุงููุงูู';
      const title = $('#cv-title').value.trim() || 'ุงููุณูู ุงููุธููู';
      const summary = $('#cv-summary').value.trim() || 'ุงูุชุจ ููุฎุตู ุงููููู ุจุฅูุฌุงุฒ ููุถูุญ.';
      const exp = $('#cv-exp').value.trim().split('\n').filter(Boolean);
      const edu = $('#cv-edu').value.trim().split('\n').filter(Boolean);
      const skills = $('#cv-skills').value.split(',').map(s=>s.trim()).filter(Boolean);

      $('#cv-name-v').textContent = name;
      $('#cv-title-v').textContent = title;
      $('#cv-summary-v').textContent = summary;

      const expV = $('#cv-exp-v'); expV.innerHTML='';
      exp.forEach(line=>{
        const p = document.createElement('p'); p.textContent = line; expV.appendChild(p);
      });
      const eduV = $('#cv-edu-v'); eduV.innerHTML='';
      edu.forEach(line=>{ const p = document.createElement('p'); p.textContent=line; eduV.appendChild(p); });

      const skillsV = $('#cv-skills-v'); skillsV.innerHTML='';
      skills.forEach(s=>{ const span=document.createElement('span'); span.className='tag'; span.textContent=s; skillsV.appendChild(span); })

      store('cv-data',{name,title,summary,exp,edu,skills,photo:load('cv-photo',null)});
    }

    document.getElementById('cv-generate').onclick = syncPreview;
    document.getElementById('cv-clear').onclick = ()=>{
      ['cv-name','cv-title','cv-summary','cv-exp','cv-edu','cv-skills'].forEach(id=>$('#'+id).value='');
      localStorage.removeItem('cv-data'); localStorage.removeItem('cv-photo');
      $('#cv-avatar').innerHTML='';
      syncPreview();
    };

    document.getElementById('cv-download').onclick = ()=>{
      const sheet = document.getElementById('cv-sheet');
      const name = ($('#cv-name').value.trim() || 'CV');
      const opt = { filename: `${name.replace(/\s+/g,'_')}.pdf`, margin: 0, image:{ type:'jpeg', quality: 0.98 }, html2canvas:{ scale: 3, useCORS:true }, jsPDF:{ unit:'pt', format:'a4', orientation:'portrait' } };
      html2pdf().set(opt).from(sheet).save();
    };

    // Photo upload
    document.getElementById('cv-photo').addEventListener('change', async (e)=>{
      const file = e.target.files?.[0]; if(!file) return;
      const reader = new FileReader();
      reader.onload = ()=>{ localStorage.setItem('cv-photo', reader.result); renderAvatar(); };
      reader.readAsDataURL(file);
    });
    function renderAvatar(){
      const data = localStorage.getItem('cv-photo');
      const box = document.getElementById('cv-avatar');
      box.innerHTML = data ? `<img src="${data}" alt=""/>` : '';
    }

    // Load persisted
    (function(){
      const data = load('cv-data',null);
      if(data){
        $('#cv-name').value=data.name||'';
        $('#cv-title').value=data.title||'';
        $('#cv-summary').value=data.summary||'';
        $('#cv-exp').value=(data.exp||[]).join('\n');
        $('#cv-edu').value=(data.edu||[]).join('\n');
        $('#cv-skills').value=(data.skills||[]).join(', ');
      }
      renderAvatar();
      syncPreview();
    })();
  </script>  <!-- jsPDF (exposed by html2pdf bundle) shim for direct access above -->  <script>window.jspdf = window.jspdf || window.jsPDF ? { jsPDF: window.jsPDF } : undefined;</script></body>
</html>
