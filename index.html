<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CV Maker — صانع سيرة ذاتية PDF مجاني</title>
  <meta name="description" content="أنشئ سيرتك الذاتية بنفسك: املأ الحقول، اختر القالب، وشاهد المعاينة الفورية ثم حمّل PDF بجودة A4. يعمل مجانًا على الهاتف والكمبيوتر." />
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0b1120;--card:#0f172a;--muted:#94a3b8;--text:#e2e8f0;--brand:#38bdf8;--brand-2:#22d3ee;--radius:1.2rem;--sheet-accent:#111}
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:
      radial-gradient(1200px 600px at 80% -10%, rgba(56,189,248,.25), transparent 60%),
      radial-gradient(900px 500px at -10% 10%, rgba(34,211,238,.20), transparent 60%), var(--bg);
      color:var(--text);font-family:"Tajawal",system-ui,-apple-system,Segoe UI,Roboto,Arial}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{max-width:1200px;margin:0 auto;padding:20px}
    .nav{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .logo{display:flex;align-items:center;gap:10px;font-weight:800}
    .logo-badge{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--brand),var(--brand-2));display:grid;place-items:center;box-shadow:0 10px 30px rgba(34,211,238,.25)}
    .badge{font-size:12px;border:1px solid rgba(226,232,240,.12);padding:6px 10px;border-radius:999px;color:#cbd5e1;background:rgba(148,163,184,.06)}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:10px;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#0b1120;font-weight:800;border:none;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(226,232,240,.15);color:var(--text)}
    .grid{display:grid;gap:16px}
    .two{grid-template-columns:360px 1fr}
    .panel{background:linear-gradient(180deg, rgba(148,163,184,.08), rgba(148,163,184,.02));border:1px solid rgba(226,232,240,.08);border-radius:var(--radius);padding:16px}

    /* Sidebar builder full-height */
    #builder{position:sticky; top:12px; height:calc(100vh - 24px); overflow:auto}

    /* Inputs */
    input,select,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(226,232,240,.12);background:#0c1326;color:var(--text);outline:none}
    textarea{min-height:90px;resize:vertical}
    label{font-weight:700;font-size:13px;margin-bottom:6px;display:block}
    .row{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    .row3{display:grid;gap:12px;grid-template-columns:1fr 1fr 1fr}

    .tools{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}

    /* CV Preview Sheet (Screen) */
    .sheet-wrap{background:#0c1326;border:1px solid rgba(226,232,240,.08);border-radius:12px;display:grid;place-items:center}
    .sheet{width:794px;min-height:1123px;background:#ffffff;color:#111;padding:26px 28px;position:relative}
    .tpl-classic h1{font-size:28px;margin:0}
    .meta{display:flex;gap:16px;flex-wrap:wrap;color:#333}
    .sec{margin-top:14px}
    .sec h3{margin:0 0 8px;border-bottom:2px solid var(--sheet-accent);display:inline-block}
    .item{margin:6px 0}
    .muted{color:#555}
    .left-right{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .skills, .langs{display:flex;gap:8px;flex-wrap:wrap}
    .chip{border:1px solid var(--sheet-accent);border-radius:999px;padding:6px 10px;font-size:12px}
    .photo{position:absolute;top:28px;left:28px;width:86px;height:86px;border-radius:10px;object-fit:cover;border:2px solid #eee}

    /* Template: Sidebar */
    .tpl-sidebar{display:grid;grid-template-columns:230px 1fr;gap:22px}
    .tpl-sidebar .side{background:#f5f7fb;border-radius:10px;padding:16px;height:fit-content}
    .tpl-sidebar .side h3{margin:0 0 6px}

    /* Color palette */
    .swatches{display:flex;gap:10px;flex-wrap:wrap}
    .swatch{width:28px;height:28px;border-radius:999px;border:2px solid rgba(255,255,255,.6);cursor:pointer;box-shadow:0 0 0 2px rgba(0,0,0,.2) inset}
    .swatch[aria-checked="true"]{outline:3px solid rgba(255,255,255,.8)}

    /* Print styles */
    @media print{
      body{background:#fff}
      .no-print{display:none!important}
      .sheet{box-shadow:none}
      @page{size:A4;margin:14mm}
    }

    @media (max-width: 980px){
      .two{grid-template-columns:1fr}
      #builder{position:static;height:auto}
      .sheet{transform:scale(.86);transform-origin:top center}
    }
  </style>
</head>
<body>
  <header class="container nav no-print">
    <div class="logo">
      <div class="logo-badge">📄</div>
      <span>CV Maker — صانع سيرة PDF</span>
    </div>
    <div class="tools">
      <button class="btn" id="btnPrint">تحميل PDF</button>
      <button class="btn ghost" id="btnSave">حفظ البيانات</button>
      <button class="btn ghost" id="btnLoad">استرجاع</button>
      <button class="btn ghost" id="btnReset">حذف الكل</button>
    </div>
  </header>

  <main class="container grid two">
    <!-- Builder -->
    <section class="panel no-print" id="builder">
      <h2 style="margin-top:0">املأ بيانات سيرتك</h2>

      <div class="row">
        <div>
          <label>الاسم الكامل</label>
          <input id="fullName" placeholder="مثال: عبد الله حكم" />
        </div>
        <div>
          <label>المسمى الوظيفي</label>
          <input id="jobTitle" placeholder="مثال: مطوّر واجهات أمامية" />
        </div>
      </div>

      <div class="row3">
        <div>
          <label>البريد الإلكتروني</label>
          <input id="email" placeholder="you@email.com" />
        </div>
        <div>
          <label>الهاتف</label>
          <input id="phone" placeholder="+49 .." />
        </div>
        <div>
          <label>الموقع/المدينة</label>
          <input id="location" placeholder="Stuttgart, DE" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>رابط (موقع/LinkedIn)</label>
          <input id="website" placeholder="https://..." />
        </div>
        <div>
          <label>صورة شخصية (اختياري)</label>
          <input id="photo" type="file" accept="image/*" />
        </div>
      </div>

      <label>الملخص المهني</label>
      <textarea id="summary" placeholder="3-4 أسطر تلخّص خبرتك وقيمتك."></textarea>

      <div class="row">
        <div>
          <label>المهارات (افصل بفواصل)</label>
          <input id="skills" placeholder="JavaScript, React, CSS, Tailwind" />
        </div>
        <div>
          <label>اللغات (افصل بفواصل)</label>
          <input id="languages" placeholder="العربية، الإنجليزية B2" />
        </div>
      </div>

      <h3 style="margin-top:10px">الخبرات</h3>
      <div id="expList"></div>
      <button class="btn" id="addExp" type="button">+ إضافة خبرة</button>

      <h3 style="margin-top:16px">التعليم</h3>
      <div id="eduList"></div>
      <button class="btn" id="addEdu" type="button">+ إضافة مؤهل</button>

      <h3 style="margin-top:16px">القالب</h3>
      <div class="tools">
        <label class="badge"><input type="radio" name="tpl" value="classic" checked> كلاسيكي</label>
        <label class="badge"><input type="radio" name="tpl" value="sidebar"> شريط جانبي</label>
      </div>

      <h3 style="margin-top:16px">اختر اللون</h3>
      <div class="swatches" id="swatches">
        <button class="swatch" type="button" data-theme='{"brand":"#38bdf8","brand2":"#22d3ee","accent":"#2563eb"}' style="background:linear-gradient(135deg,#38bdf8,#22d3ee)" aria-label="أزرق" aria-checked="true"></button>
        <button class="swatch" type="button" data-theme='{"brand":"#a78bfa","brand2":"#7c3aed","accent":"#6d28d9"}' style="background:linear-gradient(135deg,#a78bfa,#7c3aed)" aria-label="بنفسجي"></button>
        <button class="swatch" type="button" data-theme='{"brand":"#34d399","brand2":"#10b981","accent":"#047857"}' style="background:linear-gradient(135deg,#34d399,#10b981)" aria-label="أخضر"></button>
        <button class="swatch" type="button" data-theme='{"brand":"#fb7185","brand2":"#ef4444","accent":"#991b1b"}' style="background:linear-gradient(135deg,#fb7185,#ef4444)" aria-label="أحمر"></button>
        <button class="swatch" type="button" data-theme='{"brand":"#f59e0b","brand2":"#fbbf24","accent":"#b45309"}' style="background:linear-gradient(135deg,#f59e0b,#fbbf24)" aria-label="ذهبي"></button>
        <button class="swatch" type="button" data-theme='{"brand":"#06b6d4","brand2":"#22d3ee","accent":"#0e7490"}' style="background:linear-gradient(135deg,#06b6d4,#22d3ee)" aria-label="فيروزي"></button>
      </div>
    </section>

    <!-- Preview -->
    <section class="panel">
      <div class="sheet-wrap">
        <div class="sheet tpl-classic" id="sheet">
          <!-- يُعاد بناؤه تلقائيًا حسب القالب -->
        </div>
      </div>
    </section>
  </main>

  <div class="container no-print" id="testStatus" style="font-size:12px;color:#cbd5e1;margin-top:8px"></div>

  <script>
    // ===== Helpers =====
    const $  = (sel)=>document.querySelector(sel);
    const $$ = (sel)=>Array.prototype.slice.call(document.querySelectorAll(sel)); // Array دائمًا
    const on = (el, evt, fn)=>{ if(el) el.addEventListener(evt, fn); };
    const state = {exp:[], edu:[], photoData:null, tpl:'classic'};

    // ===== قوالب DOM =====
    function buildClassic(){
      return `
        <img id="p_photo" class="photo" alt="" style="display:none" />
        <h1 id="p_name">الاسم الكامل</h1>
        <div class="meta" id="p_meta"></div>
        <div class="sec"><h3>الملخص</h3><p id="p_summary" class="muted"></p></div>
        <div class="sec"><h3>الخبرات</h3><div id="p_exp"></div></div>
        <div class="left-right sec">
          <div>
            <h3>التعليم</h3>
            <div id="p_edu"></div>
          </div>
          <div>
            <h3>المهارات</h3>
            <div class="skills" id="p_skills"></div>
            <h3 style="margin-top:12px">اللغات</h3>
            <div class="langs" id="p_langs"></div>
          </div>
        </div>`;
    }
    function buildSidebar(){
      return `
        <div class="tpl-sidebar">
          <div class="side">
            <img id="p_photo" class="photo" style="position:static;width:100%;height:auto;border:none;display:${state.photoData?'block':'none'}" src="${state.photoData||''}" alt=""/>
            <h3>المهارات</h3>
            <div class="skills" id="p_skills"></div>
            <h3>اللغات</h3>
            <div class="langs" id="p_langs"></div>
            <h3>التواصل</h3>
            <div class="muted" id="p_contact"></div>
          </div>
          <div>
            <h1 id="p_name"></h1>
            <div class="meta" id="p_meta"></div>
            <div class="sec"><h3>الملخص</h3><p id="p_summary" class="muted"></p></div>
            <div class="sec"><h3>الخبرات</h3><div id="p_exp"></div></div>
            <div class="sec"><h3>التعليم</h3><div id="p_edu"></div></div>
          </div>
        </div>`;
    }

    // ===== ملء القالب بالبيانات =====
    function fillTemplate(){
      const p = (id)=>document.getElementById(id);
      if(p('p_name')) p('p_name').textContent = state.fullName || 'الاسم الكامل';

      const meta = [];
      if(state.jobTitle) meta.push(state.jobTitle);
      if(state.email)   meta.push(state.email);
      if(state.phone)   meta.push(state.phone);
      if(state.location)meta.push(state.location);
      if(state.website) meta.push(state.website);
      if(p('p_meta')) p('p_meta').textContent = meta.join(' • ');

      if(p('p_summary')) p('p_summary').textContent = state.summary || '';

      const expWrap = p('p_exp');
      if(expWrap){
        expWrap.innerHTML='';
        state.exp.forEach(x=>{
          const div=document.createElement('div');
          div.className='item';
          div.innerHTML = `<strong>${x.role||''}</strong> — ${x.company||''} <span class="muted">${x.dates||''}</span><br>${x.desc||''}`;
          expWrap.appendChild(div);
        });
      }

      const eduWrap = p('p_edu');
      if(eduWrap){
        eduWrap.innerHTML='';
        state.edu.forEach(x=>{
          const div=document.createElement('div');
          div.className='item';
          div.innerHTML = `<strong>${x.degree||''}</strong> — ${x.school||''} <span class="muted">${x.year||''}</span>${x.extra? '<br>'+x.extra:''}`;
          eduWrap.appendChild(div);
        });
      }

      const skillsWrap = p('p_skills');
      if(skillsWrap){
        skillsWrap.innerHTML='';
        state.skills.forEach(s=>{
          const span=document.createElement('span');
          span.className='chip'; span.textContent=s; skillsWrap.appendChild(span);
        });
      }

      const langsWrap = p('p_langs');
      if(langsWrap){
        langsWrap.innerHTML='';
        state.languages.forEach(s=>{
          const span=document.createElement('span');
          span.className='chip'; span.textContent=s; langsWrap.appendChild(span);
        });
      }

      const img = $('#p_photo');
      if(img){
        if(state.photoData){ img.src = state.photoData; img.style.display='block'; }
        else { img.style.display='none'; }
      }

      const contact = document.getElementById('p_contact');
      if(contact){
        contact.innerHTML = [state.email,state.phone,state.location,state.website].filter(Boolean).join('<br>');
      }
    }

    // ===== إعادة بناء وعرض المعاينة =====
    function render(){
      const sheet = $('#sheet');
      if(!sheet) return;
      sheet.classList.remove('tpl-classic','tpl-mode-sidebar');
      sheet.classList.add(state.tpl==='classic' ? 'tpl-classic' : 'tpl-mode-sidebar');
      sheet.innerHTML = state.tpl==='classic' ? buildClassic() : buildSidebar();
      fillTemplate();
    }

    // ===== عناصر ديناميكية للمدخلات =====
    function makeExpItem(item={role:'', company:'', dates:'', desc:''}){
      const wrap = document.createElement('div');
      wrap.className='panel';
      wrap.style.padding='12px';
      wrap.innerHTML = `
        <div class="row">
          <div><label>المسمى</label><input class="i-role" placeholder="مثال: مطوّر Frontend" value="${item.role||''}"></div>
          <div><label>الشركة</label><input class="i-company" placeholder="مثال: شركة X" value="${item.company||''}"></div>
        </div>
        <div class="row">
          <div><label>المدة</label><input class="i-dates" placeholder="2022 - الآن" value="${item.dates||''}"></div>
          <div><label>وصف مختصر</label><input class="i-desc" placeholder="إنجازات/مسؤوليات" value="${item.desc||''}"></div>
        </div>
        <div class="tools"><button class="btn ghost del" type="button">حذف</button></div>
      `;
      wrap.querySelector('.del').addEventListener('click',()=>{wrap.remove(); syncFromBuilder();});
      ['.i-role','.i-company','.i-dates','.i-desc'].forEach(s=>{
        wrap.querySelector(s).addEventListener('input', syncFromBuilder);
      });
      return wrap;
    }
    function makeEduItem(item={degree:'', school:'', year:'', extra:''}){
      const wrap = document.createElement('div');
      wrap.className='panel';
      wrap.style.padding='12px';
      wrap.innerHTML = `
        <div class="row">
          <div><label>الدرجة</label><input class="e-degree" placeholder="بكالوريوس حاسوب" value="${item.degree||''}"></div>
          <div><label>الجهة التعليمية</label><input class="e-school" placeholder="جامعة ..." value="${item.school||''}"></div>
        </div>
        <div class="row">
          <div><label>السنة</label><input class="e-year" placeholder="2021" value="${item.year||''}"></div>
          <div><label>تفاصيل (اختياري)</label><input class="e-extra" placeholder="مشروع تخرج/معدل" value="${item.extra||''}"></div>
        </div>
        <div class="tools"><button class="btn ghost del" type="button">حذف</button></div>
      `;
      wrap.querySelector('.del').addEventListener('click',()=>{wrap.remove(); syncFromBuilder();});
      ['.e-degree','.e-school','.e-year','.e-extra'].forEach(s=>{
        wrap.querySelector(s).addEventListener('input', syncFromBuilder);
      });
      return wrap;
    }

    on($('#addExp'),'click',()=>{ $('#expList').appendChild(makeExpItem()); syncFromBuilder(); });
    on($('#addEdu'),'click',()=>{ $('#eduList').appendChild(makeEduItem()); syncFromBuilder(); });

    // ===== رفع الصورة
    on($('#photo'),'change',(e)=>{
      const file = e.target && e.target.files && e.target.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = ()=>{ state.photoData = reader.result; render(); };
      reader.readAsDataURL(file);
    });

    // ===== تبديل القالب
    const tplRadios = $$("input[name='tpl']");
    tplRadios.forEach(r=>{ r.addEventListener('change',()=>{ state.tpl = r.value; render(); autosave(); }); });

    // ===== مزامنة البيانات من المدخلات للمعاينة
    function syncFromBuilder(){
      const g = (id)=>$(id).value? $(id).value.trim():'';
      state.fullName = $('#fullName')? g('#fullName'):'';
      state.jobTitle = $('#jobTitle')? g('#jobTitle'):'';
      state.email    = $('#email')? g('#email'):'';
      state.phone    = $('#phone')? g('#phone'):'';
      state.location = $('#location')? g('#location'):'';
      state.website  = $('#website')? g('#website'):'';
      state.summary  = $('#summary')? g('#summary'):'';
      state.skills   = $('#skills')? g('#skills').split(/,|،/).map(s=>s.trim()).filter(Boolean):[];
      state.languages= $('#languages')? g('#languages').split(/,|،/).map(s=>s.trim()).filter(Boolean):[];
      state.exp = Array.from($('#expList')? $('#expList').children:[]).map(el=>({
        role: (el.querySelector('.i-role')||{}).value?.trim()||'',
        company: (el.querySelector('.i-company')||{}).value?.trim()||'',
        dates: (el.querySelector('.i-dates')||{}).value?.trim()||'',
        desc: (el.querySelector('.i-desc')||{}).value?.trim()||'',
      })).filter(x=>x.role||x.company||x.desc||x.dates);
      state.edu = Array.from($('#eduList')? $('#eduList').children:[]).map(el=>({
        degree: (el.querySelector('.e-degree')||{}).value?.trim()||'',
        school: (el.querySelector('.e-school')||{}).value?.trim()||'',
        year: (el.querySelector('.e-year')||{}).value?.trim()||'',
        extra: (el.querySelector('.e-extra')||{}).value?.trim()||'',
      })).filter(x=>x.degree||x.school||x.year||x.extra);
      render();
      autosave();
    }
    ['#fullName','#jobTitle','#email','#phone','#location','#website','#summary','#skills','#languages']
      .forEach(sel=> on($(sel),'input', syncFromBuilder));

    // ===== حفظ/استرجاع
    function autosave(){ try{ localStorage.setItem('cv_data_v1', JSON.stringify(state)); } catch(e){ console.warn('Autosave blocked:', e); } }
    function loadSaved(){
      try{
        const raw = localStorage.getItem('cv_data_v1');
        if(!raw) return false;
        const s = JSON.parse(raw);
        Object.assign(state, s);
        if($('#fullName')) $('#fullName').value = s.fullName||'';
        if($('#jobTitle')) $('#jobTitle').value = s.jobTitle||'';
        if($('#email'))    $('#email').value = s.email||'';
        if($('#phone'))    $('#phone').value = s.phone||'';
        if($('#location')) $('#location').value = s.location||'';
        if($('#website'))  $('#website').value = s.website||'';
        if($('#summary'))  $('#summary').value = s.summary||'';
        if($('#skills'))   $('#skills').value = (s.skills||[]).join(', ');
        if($('#languages'))$('#languages').value = (s.languages||[]).join(', ');
        if($('#expList')){ $('#expList').innerHTML=''; (s.exp||[]).forEach(e=>$('#expList').appendChild(makeExpItem(e))); }
        if($('#eduList')){ $('#eduList').innerHTML=''; (s.edu||[]).forEach(e=>$('#eduList').appendChild(makeEduItem(e))); }
        state.tpl = s.tpl||'classic';
        $$("input[name='tpl']").forEach(r=>{ r.checked = (r.value===state.tpl); });
        render();
        return true;
      }catch(e){ console.warn('Load failed:', e); return false; }
    }

    // ===== ألوان ثابتة
    function applyTheme(theme){
      if(!theme) return;
      document.documentElement.style.setProperty('--brand', theme.brand);
      document.documentElement.style.setProperty('--brand-2', theme.brand2);
      document.documentElement.style.setProperty('--sheet-accent', theme.accent);
      state.theme = theme; autosave(); render();
    }
    const savedThemeRaw = localStorage.getItem('cv_theme_v1');
    if(savedThemeRaw){ try{ applyTheme(JSON.parse(savedThemeRaw)); }catch{} }

    $$('#swatches .swatch').forEach(btn=>{
      btn.addEventListener('click',()=>{
        $$('#swatches .swatch').forEach(b=>b.setAttribute('aria-checked','false'));
        btn.setAttribute('aria-checked','true');
        const theme = JSON.parse(btn.getAttribute('data-theme'));
        applyTheme(theme);
        try{ localStorage.setItem('cv_theme_v1', JSON.stringify(theme)); }catch{}
      });
    });

    // ===== أزرار أعلى الصفحة
    on($('#btnPrint'),'click',()=>{ window.print(); });
    on($('#btnSave'),'click',()=>{ autosave(); alert('تم الحفظ محليًا على هذا الجهاز.'); });
    on($('#btnLoad'),'click',()=>{ if(!loadSaved()) alert('لا توجد بيانات محفوظة.'); });
    on($('#btnReset'),'click',()=>{ if(confirm('حذف كل شيء؟')){ try{localStorage.removeItem('cv_data_v1');localStorage.removeItem('cv_theme_v1');}catch{} location.reload(); } });

    // ===== تهيئة مبدئية
    if($('#expList')) $('#expList').appendChild(makeExpItem());
    if($('#eduList')) $('#eduList').appendChild(makeEduItem());
    render();

    // ===== اختبارات ذاتية بسيطة (تظهر أسفل الصفحة)
    (function runTests(){
      const out = [];
      try{
        out.push($$("input[name='tpl']").length>0 ? '✔ توجد أزرار قوالب tpl' : '✖ لا توجد أزرار tpl');
        out.push(Array.isArray($$("input[name='tpl'])) ? '✔ $$ يعيد Array' : '✖ $$ لا يعيد Array');
        const before = state.exp.length; if($('#addExp')) $('#addExp').click();
        out.push(state.exp.length>=before ? '✔ إضافة خبرة تعمل' : '✖ مشكلة في مزامنة الخبرات');
        state.fullName = 'اختبار'; render();
        out.push((document.getElementById('p_name')?.textContent||'').includes('اختبار') ? '✔ تحديث الاسم يعمل' : '✖ تحديث الاسم لا يعمل');
        const tbtn = document.querySelector('#swatches .swatch'); if(tbtn){ tbtn.click(); out.push('✔ تبديل اللون يعمل'); }
        state.tpl='sidebar'; render();
        out.push(document.querySelector('#sheet .tpl-sidebar') ? '✔ قالب الشريط الجانبي يعمل' : '✖ فشل بناء الشريط الجانبي');
        state.tpl='classic'; render();
        out.push(document.getElementById('p_name') ? '✔ الرجوع للكلاسيكي يعمل' : '✖ فشل الرجوع للكلاسيكي');
      }catch(e){ out.push('✖ استثناء أثناء الاختبار: '+e.message); }
      const box = document.getElementById('testStatus');
      if(box) box.textContent = 'Tests: ' + out.join(' • ');
      state.fullName = ''; render();
    })();
  </script>
</body>
</html>
